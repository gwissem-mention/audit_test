// n√©cessite un lien (id getOutils) avec pour href, l'url du formulaire
tinymce.PluginManager.add('outil', function(editor, url) {

    // Add a button that opens a window
    editor.addButton('outil', {
        text: 'Outil d\'autodiagnostic',
        icon: false,
        onclick: function() {
            $.fancybox.open( $('#getOutils').val(), {
                type     : "ajax",
                autoSize : false,
                width    : 800,
                height   : 280,
                ajax     : {
                    data : {
                        texte : editor.selection.getContent({format: 'text'})
                    },
                    type : "POST"
                },
                beforeClose : function(){
                    if( $('#choix').val() == "submit" ){
                        var outil = $('#outil').val();
                        if( outil != "" ){
                            var texte = $('#texte').val();
                            var cible = $('#cible').val();
                            editor.insertContent('[' + outil + ';' + texte + ';' + cible + ']');
                        }
                    }
                }
            });
        }
    });
});
