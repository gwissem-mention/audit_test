{% extends 'HopitalNumeriqueModuleBundle:Front:layout.html.twig' %}

{% block menu_modules %}
    {# Render de la vue de récupérations des différentes modules #}
    {{ render(controller("HopitalNumeriqueModuleBundle:Front/ModuleFront:menuModules", {'module' : moduleSelectionne} )) }}
{% endblock menu_modules %}

{% block chapo_description %}
    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse consectetur leo in quam elementum dictum. Donec congue velit sit amet feugiat aliquam. Donec sagittis facilisis libero, sit amet dignissim mi vestibulum vehicula. Nulla nunc elit, congue non consequat vitae, accumsan eget enim.
{% endblock chapo_description %}

{% block contenu %}
    <div class="col-md-12">
        <div class="panel">
            {% for key,module in modules %}
                <div class="col-md-12 table-responsive">
                    <h4 class="violet">{{module.titre}}</h4>
                    <table class="table table-striped table-hover table-condensed table-bordered">
                        <thead>
                            <tr class="grid-row-titles">
                                <th>Productions concernées</th>
                                <th style="max-width:96px;">Date</th>
                                <th>Durée</th>
                                <th>Lieu</th>
                                <th>Horaires</th>
                                <th>Places</th>
                                <th>Inscrit</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for key,session in module.sessions %}
                                <tr>
                                    <td>
                                        {% for key,production in module.productions %}
                                            {{ production.titre }}
                                        {% endfor %}
                                    </td>
                                    <td>{{session.dateSession|date("d/m/Y")}}</td>
                                    <td>{{session.duree.libelle}}</td>
                                    <td>{{session.lieu}}</td>
                                    <td>{{session.horaires}}</td>
                                    <td class={% if (session.nombrePlaceDisponible - session.getInscriptionsAccepte()|length) > (session.nombrePlaceDisponible / 10) %}"success"{% elseif (session.nombrePlaceDisponible - session.getInscriptionsAccepte()|length) > 0 %}"warning"{% else %}"danger"{% endif %}>
                                        {{session.nombrePlaceDisponible - session.getInscriptionsAccepte()|length}}/{{session.nombrePlaceDisponible}}
                                    </td>
                                    <td>
                                        {% set userInscrit = false %}
                                        {% for key,inscription in session.getInscriptionsAccepte() %}
                                            {% if app.user.id == inscription.user.id %}
                                                {% set userInscrit = true %}
                                            {% endif %}
                                        {% endfor %}
                                        {% if userInscrit %}
                                            <span class="inscrit">{{session.etat.libelle}}</span>
                                        {% else %}
                                            <span class="pasInscrit">{{session.etat.libelle}}</span>
                                        {% endif %}
                                    </td>
                                    <td style="min-width:74px;">
                                        <div class="btn-group">
                                            <a class="btn btn-info link fancybox.ajax" href="{{path('hopitalnumerique_module_session_description_front',{'id':session.id})}}">?</a>
                                            <a class="btn btn-info link fancybox.ajax" href="{{path('hopitalnumerique_module_session_description_front',{'id':session.id})}}">?</a>
                                        </div>
                                    </td>
                                </tr>
                            {% endfor %}   
                        </tbody>
                    </table>
                </div>
                <div class="clearfix"></div>
            {% endfor %}
        </div>
    </div>
    <div class="clearfix"></div>
{% endblock contenu %}
