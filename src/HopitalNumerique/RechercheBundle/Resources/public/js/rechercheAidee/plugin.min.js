// nécessite un lien (id getRechercheAidee) avec pour href, l'url du formulaire
tinymce.PluginManager.add('rechercheAidee', function(editor, url) {

    // Add a button that opens a window
    editor.addButton('rechercheAidee', {
        text: 'Recherche aidée',
        icon: false,
        onclick: function() {
            $.fancybox.open( $('#getRechercheAidee').val(), {
                type     : "ajax",
                autoSize : false,
                width    : 800,
                height   : 280,
                ajax     : {
                    data : {
                        texte : editor.selection.getContent({format: 'text'})
                    },
                    type : "POST"
                },
                beforeClose : function(){
                    if( $('#choix').val() == "submit" ){
                        var rechercheAidee = $('#rechercheAidee').val();
                        if( rechercheAidee != "" ){
                            editor.insertContent('[' + rechercheAidee + ';;]');
                        }
                    }
                }
            });
        }
    });
});