<div style="padding:15px" >
    <ol class="arbo-requete">
        {% import _self as mySelf %}
        {{ mySelf.buildTree(elements, 0) }}
    </ol>
</div>

<input type="hidden" id="requete-refs" value="{{refs}}" />
<script type="text/javascript" >handleRefs()</script>

{# Construit le système de parents > enfants des catégories #}
{% macro buildTree(elements, level) %}
    {% import _self as mySelf %}
    {% for element in elements  %}
        {% if level == 1 and element.childs %}
            <li class="hide childs level{{level}} element-{{element.id}}" data-id="{{element.id}}" >
        {% else %}
            <li class="hide level{{level}} element-{{element.id}}" data-id="{{element.id}}" >
        {% endif %}
            <span>{{element.libelle}}</span>
            {% if element.childs %}
                <ol>
                    {% for child in element.childs %}
                        {{ mySelf.buildTree(child, level+1 ) }}
                    {% endfor %}
                </ol>
            {% endif %}
        </li>
    {% endfor %}
{% endmacro %}