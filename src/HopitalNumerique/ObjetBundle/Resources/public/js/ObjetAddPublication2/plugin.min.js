// n√©cessite un lien (id getObjets) avec pour href, l'url du formulaire
tinymce.PluginManager.add('publication', function(editor, url) {

    // Add a button that opens a window
    editor.addButton('publication', {
        text: 'Ajouter un lien interne',
        icon: false,
        onclick: function() {
            $.fancybox.open( $('#getObjets'), {
                type : "ajax",
                autoSize:false,
                width:800,
                height:280,
                ajax : {
                    data : {
                        texte : editor.selection.getContent({format: 'text'})
                    },
                    type : "POST"
                },
                beforeClose : function(){
                    if( $('#choix').val() == "submit" ){
                        var publication = $('#publication').val();
                        if( publication != "" ){
                            var texte = $('#texte').val();
                            var cible = $('#cible').val();
                            editor.insertContent('[' + publication + ';' + texte + ';' + cible + ']');
                        }
                    }
                }
            });
        }
    });
});