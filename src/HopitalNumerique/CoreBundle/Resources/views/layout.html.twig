<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="{% block metadesc %}Mon Hôpital Numérique{% endblock %}">
        <meta name="keywords" content="{% block metakeywords %}{% endblock %}">
        <meta name="author" content="NODEVO">

        <title>{% block title %}Mon Hôpital Numérique{% endblock %}</title>

        <link href='http://fonts.googleapis.com/css?family=Viga|Open+Sans:400,700' rel='stylesheet' type='text/css'>
        <link rel="shortcut icon" href="{{ asset('favicon.ico') }}" />
        {% block stylesheets %}
            {% stylesheets output="compiled/main-front.css" filter="cssrewrite"
                'bundles/hopitalnumeriquecore/css/bootstrap.min.css'
                'bundles/hopitalnumeriquecore/css/bootstrap-theme.min.css'
                'bundles/hopitalnumeriquecore/css/layout.css'
                'bundles/hopitalnumeriquecore/js/jqueryui.min.css'
            %}
                <link rel="stylesheet" href="{{ asset_url }}" />
            {% endstylesheets %}
        {% endblock %}

        {% block javascripts %}
            {% javascripts output="compiled/main-front.js"
                'bundles/hopitalnumeriquecore/js/jquery-1.11.0.min.js'
                'bundles/hopitalnumeriquecore/js/jqueryui-1.10.3.min.js'
                'bundles/hopitalnumeriquecore/js/jqueryui-fr.js'
                'bundles/hopitalnumeriquecore/js/bootstrap.min.js'
                'bundles/hopitalnumeriquecore/js/script.js'
            %}
                <script type="text/javascript" src="{{ asset_url }}"></script>
            {% endjavascripts %}
        {% endblock %}
    </head>

    <body>
        <div class="row" id="body">
            <div id="header">
                <a href="{{path('hopital_numerique_homepage')}}">
                    <img src="{{asset('bundles/hopitalnumeriquecore/img/anap.jpg')}}" alt="ANAP" id="logoAnap" class="pull-left" />
                </a>
                <div id="titre" class="pull-left">
                    <h1><span class="violet">Mon</span> Hôpital <span class="gris">Numérique</span></h1>
                    <h2 class="gris">Accompagnement pour l’atteinte des cibles d’usage</h2>    
                </div>
                
                <div class="loggedUser pull-right">
                    {% if app.user %}
                        {% if app.user.nom or app.user.prenom %}
                            <p>
                                <i class="common-sprite common-sprite-user-red"></i>
                                {{ app.user.prenom|capitalize }}
                            </p>
                            <p>
                                <span class="nom">{{ app.user.nom|capitalize }}</span>
                            </p>
                        {% else %}
                            <p>
                                <i class="common-sprite common-sprite-user-red"></i>
                                {{ app.user.username|capitalize }}
                            </p>
                        {% endif %}
                        <a class="infos rose" href="{{path('hopital_numerique_account_homepage')}}"> > Tableau de bord</a>
                    {% else %}
                        <a class="infos rose" href="{{path('hopital_numerique_user_inscription')}}"> > Inscriptions</a>
                    {% endif %}
                </div>
                
                <img src="{{asset('bundles/hopitalnumeriquecore/img/hn.jpg')}}" alt="HOPITAL NUMERIQUE" id="logoHn" class="pull-right" />

                <p class="violet pull-right align-right">
                    Ce projet s’inscrit dans le cadre du programme
                </p>
                
                <div class="connexion">
                    {% if app.user %}
                        <a href="{{path('account_logout')}}">Déconnexion <i class="common-sprite common-sprite-close" ></i></a>
                    {% else %}
                        <a href="{{path('account_login')}}"><i class="common-sprite common-sprite-user" ></i>Identification</a>
                    {% endif %}
                </div>

                <div class="common-sprite common-sprite-header"></div>
            </div>
            <div class="col-md-12" id="content">
                {% if app.request.attributes.get('_route') != 'hopital_numerique_homepage' %}
                    {{ knp_menu_render('menu-main-front', {'currentClass': 'active', 'ancestorClass':'active','template':'HopitalNumeriqueCoreBundle::menu.html.twig'}) }}
                    <div class="clearfix"></div>
                {% endif %}
                {{ block('flashBags') }}
                {% if error is defined and error %}
                    <div class="alert nalert-warning" onclick="$(this).slideUp();" >
                        {{ error|trans({}, 'FOSUserBundle') }}
                    </div>
                {% endif %}
                {% if invalid_username is defined %}
                    <div class="alert nalert-warning" onclick="$(this).slideUp();" >
                        {{ 'resetting.request.invalid_username'|trans({'%username%': invalid_username}, 'FOSUserBundle') }}
                    </div>
                {% endif %}
                {% block body %}{% endblock %}
                <div class="clearfix"></div>
            </div>
            <div class="col-md-12" id="footer">
                {{ knp_menu_render('menu-footer-front', {'currentClass': 'active', 'ancestorClass':'active','template':'HopitalNumeriqueCoreBundle::menu.html.twig'}) }}
            </div>
        </div>

        {% if app.user %}
            <div id="mesrequetes" class="closed">
                <div class="content" style="display:none">
                    <h3 class="violet">Mes requêtes</h3>
                    {{ render(controller("HopitalNumeriqueRechercheBundle:Requete:index", {'indexVue':false} )) }}
                    <a href="{{path('hopital_numerique_requete_homepage')}}" class="readmore"><i class="common-sprite common-sprite-arrow"></i> Gérer mes requêtes</a>
                </div>
            </div>
        {% endif %}
    </body>
</html>

{% block flashBags %}
    {% for type, messages in app.session.flashBag.all %}
        {% for message in messages %}
            <div class="alert alert-block nalert-{{type}}" onclick="$(this).slideUp();">
                {{ message }}
            </div>
        {% endfor %}
    {% endfor %}
{% endblock %}